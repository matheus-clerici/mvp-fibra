<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Upload de Planilha</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

#drop-area {
  border: 3px dashed #4a80f6;
  padding: 40px;
  background: #fff;
  width: 400px;
  text-align: center;
  border-radius: 12px;
  cursor: pointer;
}

#drop-area.hover {
  background: #e8f0ff;
}

input[type="file"] {
  display: none;
}

button {
  padding: 12px 18px;
  margin-top: 15px;
  border: none;
  border-radius: 6px;
  background: #4a80f6;
  color: white;
  font-size: 16px;
  cursor: pointer;
}
</style>
</head>
<body>

<div id="drop-area">
  <h3>Arraste sua planilha aqui</h3>
  <p>ou clique para selecionar o arquivo</p>
  <input type="file" id="fileElem" accept=".xlsx,.xls" />
</div>

<script>
const webhookUrl = "https://mcsoftwaredev.app.n8n.cloud/webhook/f405f832-a588-4cc9-813d-af3398c2709b"; //⬅️ coloque o URL do seu webhook

const dropArea = document.getElementById('drop-area');
const fileInput = document.getElementById('fileElem');

dropArea.onclick = () => fileInput.click();

fileInput.onchange = () => sendFile(fileInput.files[0]);

dropArea.addEventListener("dragover", (e) => {
  e.preventDefault();
  dropArea.classList.add("hover");
});

dropArea.addEventListener("dragleave", () => {
  dropArea.classList.remove("hover");
});

dropArea.addEventListener("drop", (e) => {
  e.preventDefault();
  dropArea.classList.remove("hover");
  const file = e.dataTransfer.files[0];
  sendFile(file);
});

function sendFile(file) {
  const formData = new FormData();
  formData.append("data", file);

  fetch(webhookUrl, {
    method: "POST",
    body: formData
  })
  .then(() => alert("Arquivo enviado com sucesso!"))
  .catch(err => alert("Erro ao enviar: " + err));
}
</script>

</body>
</html>
